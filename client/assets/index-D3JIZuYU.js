import{u as m,r as n,j as e,A as o,F as r,a as b,s as k,b as j,c as f,d as A,e as C,f as P,g as w,C as I,h as D,P as E,i as R,k as h,l as T,m as z,n as B,o as Q,E as V}from"./index-Dx58Rt-t.js";import{Q as F}from"./QuantityInput-BQUTWKwf.js";import{D as W}from"./DarkButton-B6Ax7bn1.js";import{S as N}from"./serverAPIs-C9DFLgdu.js";import{g as _}from"./getDefer-D-PQy0Qb.js";function u({imgSrc:s,imgAlt:a,onHandleThumbnail:t}){return e.jsx("img",{src:s,alt:a,onClick:t==null?void 0:t.bind(null,[s]),className:"cursor-pointer h-16 md:h-14 lg:h-16 2xl:h-24 object-cover fade-in"})}function $({product:s,onHandleThumbnail:a}){return e.jsxs("div",{className:"flex flex-col gap-2 h-full",children:[s.img1&&e.jsx(u,{imgSrc:s.img1,imgAlt:s.name,onHandleThumbnail:a}),s.img2&&e.jsx(u,{imgSrc:s.img2,imgAlt:s.name,onHandleThumbnail:a}),s.img3&&e.jsx(u,{imgSrc:s.img3,imgAlt:s.name,onHandleThumbnail:a}),s.img4&&e.jsx(u,{imgSrc:s.img4,imgAlt:s.name,onHandleThumbnail:a})]})}function q({currentImg:s,setCurrentImg:a}){const t=b();return n.useEffect(()=>{t&&t.img1&&a(t.img1)},[t]),e.jsx("img",{src:s,alt:t==null?void 0:t.name,className:"h-full w-full object-cover fade-in"})}function L({className:s}){const{product:a}=m(),[t,c]=n.useState("");return e.jsxs("div",{className:`${s} grid grid-cols-4 gap-4`,children:[e.jsx("div",{className:"col-start-1 col-end-2",children:e.jsx(n.Suspense,{fallback:e.jsx(r,{}),children:e.jsx(o,{resolve:a,children:l=>l?e.jsx($,{product:l,onHandleThumbnail:c}):e.jsx(r,{})})})}),e.jsx("div",{className:"col-start-2 col-end-5",children:e.jsx(n.Suspense,{fallback:e.jsx(r,{}),children:e.jsx(o,{resolve:a,children:e.jsx(q,{currentImg:t,setCurrentImg:c})})})})]})}async function M(){const s=k.dispatch;try{const a=await fetch(N.authenState,{credentials:"include"});return a.ok?!0:(s(j()),s(f(await a.json())),!1)}catch(a){a.status||(s(j()),s(f({statusText:"Failed to connect to server, please check your network"})))}}function G({product:s}){const[a,t,c]=A(1),l=()=>c(d=>++d),i=()=>c(d=>--d),x=C(),y=P(),S=async()=>{await M()&&(y(w({item:s,quantity:a})),x.submit({productId:s.id,quantity:a},{method:"post",action:I.Cart,encType:"application/json"}))};return e.jsx("div",{className:"flex fade-in",children:e.jsxs("div",{className:"flex gap-4 items-center border border-zinc-950",children:[e.jsx("span",{className:"px-4 py-2 uppercase",children:"Quantity"}),e.jsx(F,{val:a,onChangeVal:t,increment:l,decrement:i}),e.jsx(W,{onClick:S,className:"px-8 py-2 capitalize italic ",children:"Add to cart"})]})})}function p({product:s,className:a,isFallback:t=!1}){return e.jsxs("div",{className:`${a} flex flex-col gap-4 h-full justify-between left-in`,children:[e.jsx("h1",{className:"uppercase text-black text-3xl 2xl:text-5xl",children:t?e.jsx(r,{}):s.name}),e.jsx("span",{className:"text-xl",children:t?e.jsx(r,{}):D(s.price)+" VNĐ"}),e.jsx("p",{children:t?e.jsx(r,{}):s.short_desc}),e.jsxs("p",{children:[e.jsx("span",{className:"uppercase text-black mr-2",children:"Category:"}),t?e.jsx(r,{}):s.category]}),e.jsx("div",{children:e.jsx(G,{product:s})})]})}function J({className:s}){const{product:a}=m();return e.jsx(n.Suspense,{fallback:e.jsx(p,{className:s,isFallback:!0}),children:e.jsx(o,{resolve:a,children:t=>t?e.jsx(p,{product:t,className:s}):e.jsx("p",{children:"Product not found"})})})}function g({product:s,className:a,isFallback:t=!1}){var l;const c=((l=s==null?void 0:s.long_desc)==null?void 0:l.split(`
`))||new Array("","","");return e.jsxs("div",{className:`${a} flex flex-col gap-4 2xl:gap-6 left-in`,children:[e.jsx("div",{children:e.jsx("span",{className:"inline-block bg-zinc-900 text-white px-5 py-3 uppercase",children:"Description"})}),e.jsx("h3",{className:"uppercase text-black text-xl 2xl:text-2xl",children:"Product Description"}),e.jsx("article",{className:"flex flex-col gap-1 2xl:gap-2",children:c==null?void 0:c.map((i,x)=>e.jsx("p",{className:x===0?"uppercase mb-1":"",children:t?e.jsx(r,{}):i},x))})]})}function K({className:s}){const{product:a}=m();return e.jsx(n.Suspense,{fallback:e.jsx(g,{className:s,isFallback:!0}),children:e.jsx(o,{resolve:a,children:t=>t?e.jsx(g,{product:t,className:s}):e.jsx("p",{children:"Product not found"})})})}function v({product:s,className:a,isFallback:t=!1}){const[c,l]=n.useState();return!t&&n.useEffect(()=>{(async function(){const i=await _({url:N.findByCategory+s.category,includeCookie:!0});l(i||[])})()},[s]),e.jsxs("div",{className:a,children:[e.jsx(E,{}),e.jsx("h4",{className:"text-2xl uppercase mb-6",children:"Related Products"}),e.jsxs(R,{children:[t&&e.jsx(h,{}),t||!c&&e.jsx(h,{}),c==null?void 0:c.map(i=>e.jsx(T,{product:i},i.id))]}),!t&&(c==null?void 0:c.length)===0&&e.jsx("div",{className:"bg-zinc-200 py-10 text-center animate-pulse",children:"Any related product found!"})]})}function O({className:s}){const{product:a}=m();return e.jsx(n.Suspense,{fallback:e.jsx(v,{className:s,isFallback:!0}),children:e.jsx(o,{resolve:a,children:t=>t?e.jsx(v,{product:t,className:s}):e.jsx("p",{children:"Product not found"})})})}function U(){const s=z().state;n.useEffect(()=>{s==="idle"&&scrollTo({top:0,left:0,behavior:"smooth"})},[s])}function se(){return B(),U(),e.jsxs(Q,{className:"italic text-zinc-500 text-xs xl:text-sm 2xl:text-xl",children:[e.jsxs("div",{className:"grid md:grid-cols-5 gap-4 2xl:gap-10 w-full",children:[e.jsx(L,{className:"md:col-start-1 md:col-end-3"}),e.jsx(J,{className:"md:col-start-3 md:col-end-6"}),e.jsx(K,{className:"mt-8 md:col-start-1 md:col-end-6"}),e.jsx(O,{className:"mt-8 mb-32 md:col-start-1 md:col-end-6"})]}),e.jsx(V,{})]})}export{se as default};
