import{u as m,r as c,j as e,A as x,F as i,a as b,s as k,b as j,c as h,d as C,e as A,f as I,g as P,C as w,h as D,P as Q,i as R,k as f,l as T,m as V,n as z,o as E}from"./index-CqyRaQI7.js";import{Q as B}from"./QuantityInput-p7HfLRUZ.js";import{D as q}from"./DarkButton-BF9XeEeL.js";import{S as v}from"./serverAPIs-PUWDsLPn.js";import{g as W}from"./getDefer-D-PQy0Qb.js";function u({imgSrc:s,imgAlt:a,onHandleThumbnail:t}){return e.jsx("img",{src:s,alt:a,onClick:t==null?void 0:t.bind(null,[s]),className:"cursor-pointer h-16 md:h-14 lg:h-16 2xl:h-24 object-cover fade-in"})}function _({product:s,onHandleThumbnail:a}){return e.jsxs("div",{className:"flex flex-col gap-2 h-full",children:[s.img1&&e.jsx(u,{imgSrc:s.img1,imgAlt:s.name,onHandleThumbnail:a}),s.img2&&e.jsx(u,{imgSrc:s.img2,imgAlt:s.name,onHandleThumbnail:a}),s.img3&&e.jsx(u,{imgSrc:s.img3,imgAlt:s.name,onHandleThumbnail:a}),s.img4&&e.jsx(u,{imgSrc:s.img4,imgAlt:s.name,onHandleThumbnail:a})]})}function $({currentImg:s,setCurrentImg:a}){const t=b();return c.useEffect(()=>{t&&t.img1&&a(t.img1)},[t]),e.jsx("img",{src:s,alt:t==null?void 0:t.name,className:"h-full w-full object-cover fade-in"})}function F({className:s}){const{product:a}=m(),[t,n]=c.useState("");return e.jsxs("div",{className:`${s} grid grid-cols-4 gap-4`,children:[e.jsx("div",{className:"col-start-1 col-end-2",children:e.jsx(c.Suspense,{fallback:e.jsx(i,{}),children:e.jsx(x,{resolve:a,children:l=>l?e.jsx(_,{product:l,onHandleThumbnail:n}):e.jsx(i,{})})})}),e.jsx("div",{className:"col-start-2 col-end-5",children:e.jsx(c.Suspense,{fallback:e.jsx(i,{}),children:e.jsx(x,{resolve:a,children:e.jsx($,{currentImg:t,setCurrentImg:n})})})})]})}async function L(){const s=k.dispatch;try{const a=await fetch(v.authenState,{credentials:"include"});return a.ok?!0:(s(j("error")),s(h({...await a.json(),status:a.status})),!1)}catch(a){a.status||(s(j("error")),s(h({statusText:"Failed to connect to server, please check your network"})))}}function M({product:s}){const[a,t,n]=C(1),l=()=>n(o=>++o),r=()=>n(o=>o>1?--o:o),d=A(),N=I(),S=async()=>{await L()&&(N(P({item:s,quantity:a})),d.submit({productId:(s==null?void 0:s.id)||"",quantity:a},{method:"post",action:w.Cart,encType:"application/json"}))};return e.jsx("div",{className:"flex fade-in",children:e.jsxs("div",{className:"flex gap-4 items-center border border-zinc-950",children:[e.jsx("span",{className:"px-4 py-2 uppercase",children:"Quantity"}),e.jsx(B,{val:a,onChangeVal:t,increment:l,decrement:r}),e.jsx(q,{onClick:S,className:"px-8 py-2 capitalize italic ",disabled:((s==null?void 0:s.availableQuantity)||0)<a,children:"Add to cart"})]})})}function p({product:s,className:a,isFallback:t=!1}){return e.jsxs("div",{className:`${a} flex flex-col gap-4 h-full justify-between left-in`,children:[e.jsx("h1",{className:"uppercase text-black text-3xl 2xl:text-5xl",children:t?e.jsx(i,{}):s.name}),e.jsx("span",{className:"text-xl",children:t?e.jsx(i,{}):D(s.price)+" VNĐ"}),e.jsx("p",{children:t?e.jsx(i,{}):s.short_desc}),e.jsxs("p",{children:[e.jsx("span",{className:"uppercase text-black mr-2",children:"Category:"}),t?e.jsx(i,{}):s.category]}),e.jsxs("p",{children:[e.jsx("span",{className:"uppercase text-black mr-2",children:"Instock: "}),t?e.jsx(i,{}):s.availableQuantity]}),e.jsx("div",{children:e.jsx(M,{product:s})})]})}function G({className:s}){const{product:a}=m();return e.jsx(c.Suspense,{fallback:e.jsx(p,{className:s,isFallback:!0}),children:e.jsx(x,{resolve:a,children:t=>t?e.jsx(p,{product:t,className:s}):e.jsx("p",{children:"Product not found"})})})}function g({product:s,className:a,isFallback:t=!1}){var l;const n=((l=s==null?void 0:s.long_desc)==null?void 0:l.split(`
`))||new Array("","","");return e.jsxs("div",{className:`${a} flex flex-col gap-4 2xl:gap-6 left-in`,children:[e.jsx("div",{children:e.jsx("span",{className:"inline-block bg-zinc-900 text-white px-5 py-3 uppercase",children:"Description"})}),e.jsx("h3",{className:"uppercase text-black text-xl 2xl:text-2xl",children:"Product Description"}),e.jsx("article",{className:"flex flex-col gap-1 2xl:gap-2",children:n==null?void 0:n.map((r,d)=>e.jsx("p",{className:d===0?"uppercase mb-1":"",children:t?e.jsx(i,{}):r},d))})]})}function J({className:s}){const{product:a}=m();return e.jsx(c.Suspense,{fallback:e.jsx(g,{className:s,isFallback:!0}),children:e.jsx(x,{resolve:a,children:t=>t?e.jsx(g,{product:t,className:s}):e.jsx("p",{children:"Product not found"})})})}function y({product:s,className:a,isFallback:t=!1}){const[n,l]=c.useState();return c.useEffect(()=>{t||async function(){const r=await W({url:v.findByCategory+s.category,includeCookie:!0});l(r||[])}()},[s]),e.jsxs("div",{className:a,children:[e.jsx(Q,{}),e.jsx("h4",{className:"text-2xl uppercase mb-6",children:"Related Products"}),e.jsxs(R,{children:[t&&e.jsx(f,{}),t||!n&&e.jsx(f,{}),n==null?void 0:n.map(r=>e.jsx(T,{product:r},r.id))]}),!t&&(n==null?void 0:n.length)===0&&e.jsx("div",{className:"bg-zinc-200 py-10 text-center animate-pulse",children:"Any related product found!"})]})}function K({className:s}){const{product:a}=m();return e.jsx(c.Suspense,{fallback:e.jsx(y,{className:s,isFallback:!0}),children:e.jsx(x,{resolve:a,children:t=>t?e.jsx(y,{product:t,className:s}):e.jsx("p",{children:"Product not found"})})})}function O(){const s=V().state;c.useEffect(()=>{s==="idle"&&scrollTo({top:0,left:0,behavior:"smooth"})},[s])}function ee(){return z(),O(),e.jsx(E,{className:"min-h-screen italic text-zinc-500 text-xs xl:text-sm 2xl:text-xl",children:e.jsxs("div",{className:"grid md:grid-cols-5 gap-4 2xl:gap-10 w-full",children:[e.jsx(F,{className:"md:col-start-1 md:col-end-3"}),e.jsx(G,{className:"md:col-start-3 md:col-end-6"}),e.jsx(J,{className:"mt-8 md:col-start-1 md:col-end-6"}),e.jsx(K,{className:"mt-8 mb-32 md:col-start-1 md:col-end-6"})]})})}export{ee as default};
